<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…³äºæˆ‘ä»¬ - The Grace</title>
    <link rel="stylesheet" href="css/style.css?v=14">
    <link rel="stylesheet" href="css/about.css?v=14">
</head>

<body>
    <audio id="bgm" src="music/bgm.mp3" loop></audio>
    <div class="music-bar">
        <button id="music-btn" class="music-btn" title="æ’­æ”¾/æš‚åœéŸ³ä¹">ğŸµ</button>
    </div>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-title">The Grace</a>
            <div class="nav-links">
                <a href="about.html">å…³äºæˆ‘ä»¬</a>
            </div>
        </div>
    </nav>


    <div class="home-container">
        <div class="home-title">å…³äºæˆ‘ä»¬</div>
        <div class="story-cards" id="story-cards">
            <!-- æ•…äº‹å¡ç‰‡å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
        </div>
        <button class="show-more-btn" id="show-more-btn">æŸ¥çœ‹æ›´å¤š</button>
        <a class="button" href="index.html">è¿”å›é¦–é¡µ</a>
    </div>
    <script type="module">
        import stories from './js/stories.js';

        const storyCardsContainer = document.getElementById('story-cards');
        const btn = document.getElementById('show-more-btn');
        const VISIBLE_CARDS = 12; // åˆå§‹æ˜¾ç¤ºçš„æ•…äº‹æ•°é‡

        // åˆ›å»ºæ•…äº‹å¡ç‰‡
        function createStoryCard(story) {
            const isGirl = story.id % 2 === 1;
            return `
            <div class="story-card ${isGirl ? 'girl' : 'boy'} ${story.id > VISIBLE_CARDS ? 'hidden-story' : ''}">
                ${isGirl ? `
                    <div class="avatar"><img src="images/girl-avatar.png" alt="å¥³ç”Ÿå¤´åƒ" class="avatar-img"></div>
                    <div class="bubble girl-bubble">
                        <span class="story-num">${story.id} ${story.emoji}</span>
                        <p>${story.content}</p>
                    </div>
                ` : `
                    <div class="avatar"><img src="images/boy-avatar.png" alt="ç”·ç”Ÿå¤´åƒ" class="avatar-img"></div>
                    <div class="bubble boy-bubble">
                        <span class="story-num">${story.id} ${story.emoji}</span>
                        <p>${story.content}</p>
                    </div>
                `}
            </div>
        `;
        }

        // æ¸²æŸ“æ•…äº‹å¡ç‰‡
        function renderStories() {
            storyCardsContainer.innerHTML = stories.map(createStoryCard).join('');
        }

        // å¤„ç†"æŸ¥çœ‹æ›´å¤š"æŒ‰é’®ç‚¹å‡»
        let expanded = false;
        btn.onclick = function () {
            const hiddenStories = document.querySelectorAll('.story-card.hidden-story');
            if (!expanded) {
                hiddenStories.forEach(card => card.style.display = 'flex');
                btn.textContent = 'æ”¶èµ·';
                expanded = true;
            } else {
                hiddenStories.forEach(card => card.style.display = 'none');
                btn.textContent = 'æŸ¥çœ‹æ›´å¤š';
                expanded = false;
                window.scrollTo({ top: btn.offsetTop - 200, behavior: 'smooth' });
            }
        };

        // éŸ³ä¹æ§åˆ¶
        const musicBtn = document.getElementById('music-btn');
        const bgm = document.getElementById('bgm');
        let playing = false;
        musicBtn.addEventListener('click', function () {
            if (bgm.paused) {
                bgm.play();
                playing = true;
                musicBtn.textContent = 'â¸ï¸';
            } else {
                bgm.pause();
                playing = false;
                musicBtn.textContent = 'ğŸµ';
            }
        });

        // åˆå§‹åŒ–
        renderStories();
        document.querySelectorAll('.story-card.hidden-story').forEach(card => card.style.display = 'none');
    </script>
</body>

</html>